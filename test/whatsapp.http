### Variáveis
@baseUrl = http://localhost:3000/api
@token = seu_jwt_token_aqui
@companyId = 1

### 1. Autenticação e Credenciais

# 1.1 Criar nova credencial WhatsApp
POST {{baseUrl}}/whatsapp/auth?companyId={{companyId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "clientId": "seu_client_id",
  "clientSecret": "seu_client_secret",
  "fbExchangeToken": "seu_fb_exchange_token"
}

# 1.2 Atualizar credencial existente
PUT {{baseUrl}}/whatsapp/auth/1?companyId={{companyId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "clientId": "novo_client_id",
  "clientSecret": "novo_client_secret",
  "fbExchangeToken": "novo_fb_exchange_token"
}

# 1.3 Obter histórico de credenciais
GET {{baseUrl}}/whatsapp/auth/history?companyId={{companyId}}
Authorization: Bearer {{token}}

# 1.4 Obter credencial ativa atual
GET {{baseUrl}}/whatsapp/channels/1/credentials?companyId={{companyId}}
Authorization: Bearer {{token}}

### 2. Gerenciamento de Canais

# 2.1 Criar novo canal
POST {{baseUrl}}/whatsapp/channels
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "name": "Canal Principal",
  "number": "5511999999999",
  "description": "Canal principal da empresa",
  "companyId": {{companyId}},
  "departmentId": 1,
  "isDefault": true
}

# 2.2 Listar todos os canais
GET {{baseUrl}}/whatsapp/channels?companyId={{companyId}}
Authorization: Bearer {{token}}

# 2.3 Obter canal específico
GET {{baseUrl}}/whatsapp/channels/1?companyId={{companyId}}
Authorization: Bearer {{token}}

# 2.4 Atualizar canal
PUT {{baseUrl}}/whatsapp/channels/1?companyId={{companyId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "name": "Canal Atualizado",
  "description": "Nova descrição do canal"
}

# 2.5 Deletar canal
DELETE {{baseUrl}}/whatsapp/channels/1?companyId={{companyId}}
Authorization: Bearer {{token}}

### 3. Conexão e Status

# 3.1 Conectar canal
POST {{baseUrl}}/whatsapp/channels/1/connect?companyId={{companyId}}
Authorization: Bearer {{token}}

# 3.2 Desconectar canal
POST {{baseUrl}}/whatsapp/channels/1/disconnect?companyId={{companyId}}
Authorization: Bearer {{token}}

# 3.3 Verificar status do canal
GET {{baseUrl}}/whatsapp/channels/1/status?companyId={{companyId}}
Authorization: Bearer {{token}}

### 4. Mensagens

# 4.1 Enviar mensagem
POST {{baseUrl}}/whatsapp/channels/1/messages?companyId={{companyId}}
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "to": "5511999999999",
  "type": "text",
  "text": "Olá, esta é uma mensagem de teste!"
}

### 5. Webhook

# 5.1 Receber webhook do WhatsApp
POST {{baseUrl}}/whatsapp/webhook
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "object": "whatsapp_business_account",
  "entry": [
    {
      "id": "WHATSAPP_BUSINESS_ACCOUNT_ID",
      "changes": [
        {
          "value": {
            "messaging_product": "whatsapp",
            "metadata": {
              "display_phone_number": "5511999999999",
              "phone_number_id": "PHONE_NUMBER_ID"
            },
            "messages": [
              {
                "from": "5511888888888",
                "id": "wamid.123",
                "timestamp": "1234567890",
                "type": "text",
                "text": {
                  "body": "Olá, esta é uma mensagem de teste!"
                }
              }
            ]
          },
          "field": "messages"
        }
      ]
    }
  ]
} 